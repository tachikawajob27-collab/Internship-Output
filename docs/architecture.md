# Architecture（全体設計）

本リポジトリは、二次代理店〜一次代理店の運用業務を支える業務自動化システム群（Google Apps Script + Google Spreadsheet + Slack）を、公開用に整理したものです。

## 1. 全体像
各システムは「フォーム/入力 → 台帳（Spreadsheet） → 自動処理（GASトリガー） → 出力/通知（Spreadsheet/Slack）」の流れで統一しています。  
運用の中心をスプレッドシートに置き、担当者の作業はチェックや更新など最小限の操作で完結する設計です。

- 入力：Google Forms / Spreadsheet入力
- 処理：Google Apps Script（onFormSubmit / onEdit 等のトリガー）
- 台帳：Google Spreadsheet（申請管理、資産台帳、案件進捗）
- 通知：Slack（Webhook、公開用ではScript Properties管理）

## 2. 構成要素
### 2.1 Google Spreadsheet（運用台帳）
- 申請管理シート：申請内容、ステータス、担当者の操作欄（チェックボックス等）
- 出力シート：外部ツール連携用（例：B2クラウドCSV形式）
- 資産/案件台帳：端末や契約進捗など、社内管理の基礎データ

### 2.2 Google Apps Script（自動化ロジック）
- フォーム送信イベントで初期化（ステータス付与、入力規則付与など）
- セル編集イベントで処理実行（チェックONで出力生成、番号入力で台帳更新など）
- エラー時はログシートへ記録し、運用で追跡可能にする

### 2.3 Slack（通知）
- 申請や依頼の発生をチャンネルへ通知し、対応の抜け漏れを防止
- Webhook URL等の機密は公開用としてソースに含めず、Script Propertiesで管理

## 3. システム別の役割

### 3.1 1-1 タブレット送付通知システム
**目的：** 端末送付の申請受付〜送り状出力〜資産台帳更新を連動させ、転記ミスと処理遅延を削減する。  
**主なデータ流れ：**
1) フォーム入力 → 発送管理シートに行追加  
2) 初期化：発送ステータス付与、チェックボックス列の自動整備  
3) 担当者が「発送対象」をON → B2クラウド出力用CSVを1行生成（重複防止）  
4) 端末番号From/To入力 → 資産管理シートの該当端末行を更新（存在しなければ追記）  
5) 必要に応じてSlack通知（公開用ではダミー/プロパティ管理）

### 3.2 1-2 名刺作成依頼通知システム
**目的：** 名刺作成依頼の受付・通知・台帳化を自動化し、依頼対応の漏れを防止する。  
（※公開用では実データ・社内フローは伏せ、入力→台帳→通知の枠組みを示す）

### 3.3 1-3 代理店案件管理（契約進捗管理）システム
**目的：** 代理店ごとの案件・契約ステータスを一元管理し、進捗更新を標準化する。  
（※公開用では実データ・社内指標は伏せ、台帳設計と更新フローを示す）
